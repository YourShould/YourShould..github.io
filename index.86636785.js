import{g as L,h as _}from"./moment.7e0d4702.js";import{u as N}from"./detail.2c048776.js";import{e as O,d as y,u as R,r as U,o as b,c as o,a as s,b as I,i as V,_ as C}from"./index.fdf04471.js";import{u as E}from"./setting.aa29e6ad.js";const j=O("new",{state:()=>({page:window.localStorage.getItem("newPageNum")||1})});function F(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!V(r)}const J=y({setup(){const r=N(),l=E(),c=R(),u=j(),a=U({currentPage:+u.page,total:999,list:[],allData:[]}),{DEV:d}={BASE_URL:"/test/",MODE:"production",DEV:!1,PROD:!0},g=10;let i=JSON.parse(window.localStorage.getItem("read")||"[]");b(()=>{D()});const S=e=>{let t=e.split("/");return t[2]?t=t[2]:t="",t},w=()=>{var e;l.domain&&((e=a.allData)==null||e.forEach(t=>{var n;t.imgURL=(n=t.imgURL)==null?void 0:n.replace(S(t.imgURL),l.domain)}))},D=()=>{L().then(e=>{const t=JSON.parse(decodeURIComponent(e.data));a.allData=t.sort(x("date","desc")),w(),a.total=a.allData.length,m()})},m=()=>{const e=(a.currentPage-1)*g;a.list=a.allData.slice(e,a.currentPage*g),u.page=a.currentPage,window.localStorage.setItem("newPageNum",a.currentPage)},v=e=>{r.item=e,window.sessionStorage.setItem("item",JSON.stringify(e));const{title:t}=e,n=t.split("_")[0];i.push(n),i=Array.from(new Set(i)),window.localStorage.setItem("read",JSON.stringify(i)),c.push({name:"detail"})},x=(e,t="desc")=>(n,h)=>{const p=_(n[e]).valueOf(),f=_(h[e]).valueOf();return t==="desc"?p-f:f-p},P=e=>{const t=e.split("_");return i.some(n=>n===t[0])};return()=>{let e;return o("div",{class:"flexbox column box"},[o(s("van-nav-bar"),{title:"\u6700\u65B0","left-text":"\u8FD4\u56DE","left-arrow":!0,onClickLeft:()=>c.go(-1)},null),o("div",{class:"flex content"},[o(s("van-grid"),{border:!1,"column-num":2},F(e=a.list.map(t=>o(s("van-grid-item"),{onClick:()=>v(t)},{default:()=>[o(s("van-image"),{class:"img",src:d?"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg":t.imgURL},null),o("p",{class:"title"},[P(t.title)&&o(s("van-tag"),{class:"mr10",plain:!0,type:"warning"},{default:()=>[I("\u5DF2\u9605")]}),d?t.title2:t.title]),o("div",{class:"date"},[t.date])]})))?e:{default:()=>[e]})]),o(s("van-pagination"),{modelValue:a.currentPage,"onUpdate:modelValue":t=>a.currentPage=t,"total-items":a.total,"show-page-size":5,"force-ellipses":!0,onChange:m},null)])}}});const M=C(J,[["__scopeId","data-v-afc06d36"]]);export{M as default};
